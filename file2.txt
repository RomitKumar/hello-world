These changes are by surya
Here are some more changes.
